<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Commands for Real-World Scenarios</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üßë‚Äçüíª Git Commands for Real-World Scenarios</h1>
            <p class="subtitle">Production-ready Git workflows for engineering teams</p>
        </header>

        <div class="interactive-tools">
            <button class="tool-button" onclick="openSimulator()">
                <span class="tool-icon">üéÆ</span>
                <span class="tool-title">Command Simulator</span>
                <span class="tool-desc">Practice Git commands in a safe sandbox</span>
            </button>
            <button class="tool-button" onclick="openDecisionTree()">
                <span class="tool-icon">üå≥</span>
                <span class="tool-title">Decision Tree</span>
                <span class="tool-desc">Find the right command for your situation</span>
            </button>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Search scenarios... (e.g., 'merge conflict', 'undo commit', 'branch')">
        </div>

        <div class="nav-tabs">
            <button class="nav-tab" onclick="showTab(event, 'basics')">Diagnostics & Setup</button>
            <button class="nav-tab" onclick="showTab(event, 'workflows')">Workflows</button>
            <button class="nav-tab" onclick="showTab(event, 'troubleshooting')">Troubleshooting</button>
            <button class="nav-tab" onclick="showTab(event, 'advanced')">Advanced</button>
        </div>

        <div id="basics" class="tab-content">
            <div class="grid">
                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üîç</span>
                        <h3 class="scenario-title">Repository Diagnostics</h3>
                    </div>
                    <p class="scenario-description">First step in debugging any Git issue: understand your current state.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Check if current folder is a Git repo
ls -a                                    # Show hidden files (.git folder)
git rev-parse --is-inside-work-tree     # Returns true/false
git status                              # Current repo state
git remote -v                          # Show remote URLs
git branch -a                          # List all branches</pre>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">üí° Pro Tip</div>
                        Run these commands first when inheriting any codebase or debugging Git issues.
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üå±</span>
                        <h3 class="scenario-title">Starting Fresh (New Project)</h3>
                    </div>
                    <p class="scenario-description">Initialize a new repository and connect to GitHub.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Navigate to your project
cd ~/Documents/my-project

# Initialize Git repo
git init
git add .
git commit -m "Initial commit"

# Set main branch and connect to GitHub
git branch -M main
git remote add origin https://github.com/username/repo.git
git push -u origin main</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üì¶</span>
                        <h3 class="scenario-title">Cloning Existing Repo</h3>
                    </div>
                    <p class="scenario-description">Get a copy of an existing repository.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Clone from GitHub
git clone https://github.com/username/repo.git

# Navigate into the repo
cd repo

# Verify setup
git remote -v
git branch -a</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üóëÔ∏è</span>
                        <h3 class="scenario-title">Ignore Files (.gitignore)</h3>
                    </div>
                    <p class="scenario-description">Prevent sensitive or generated files from being tracked.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Create .gitignore file
touch .gitignore

# Common patterns for React/Node.js projects:
node_modules/
.env
.env.local
.DS_Store
dist/
build/
*.log
.vscode/
.idea/</pre>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">üí° Pro Tip</div>
                        Use <a href="https://gitignore.io" style="color: var(--accent);">gitignore.io</a> to generate .gitignore templates for your stack.
                    </div>
                </div>
            </div>
        </div>

        <div id="workflows" class="tab-content">
            <div class="grid">
                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üîÄ</span>
                        <h3 class="scenario-title">Feature Branch Workflow</h3>
                    </div>
                    <p class="scenario-description">Standard workflow for feature development in teams.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Create and switch to feature branch
git checkout -b feature/user-authentication

# Make your changes, then commit
git add .
git commit -m "Add user authentication system"

# Push feature branch
git push -u origin feature/user-authentication

# Switch back to main and merge
git checkout main
git merge feature/user-authentication

# Clean up
git branch -d feature/user-authentication
git push origin --delete feature/user-authentication</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üõü</span>
                        <h3 class="scenario-title">Stashing Work</h3>
                    </div>
                    <p class="scenario-description">Temporarily save uncommitted changes.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Save current changes
git stash

# Save with a message
git stash push -m "WIP: refactoring auth logic"

# List stashes
git stash list

# Apply latest stash
git stash pop

# Apply specific stash
git stash pop stash@{1}

# Apply without removing from stash
git stash apply

# Delete stash
git stash drop stash@{1}</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üìå</span>
                        <h3 class="scenario-title">Tagging Releases</h3>
                    </div>
                    <p class="scenario-description">Mark specific commits as release points.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Create lightweight tag
git tag v1.0.0

# Create annotated tag (recommended)
git tag -a v1.0.0 -m "Release version 1.0.0"

# Tag specific commit
git tag -a v1.0.1 abc1234 -m "Hotfix release"

# Push tags to remote
git push origin --tags

# List tags
git tag -l

# Delete tag
git tag -d v1.0.0
git push origin --delete v1.0.0</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üïí</span>
                        <h3 class="scenario-title">History & Inspection</h3>
                    </div>
                    <p class="scenario-description">Examine commit history and changes.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Compact history
git log --oneline

# Detailed history with stats
git log --stat

# Visual branch history
git log --graph --pretty=format:'%h -%d %s (%cr) &lt;%an&gt;'

# See who changed each line
git blame filename

# Show changes in specific commit
git show abc1234

# Compare branches
git diff main..feature/login</pre>
                    </div>
                </div>
            </div>
        </div>

        <div id="troubleshooting" class="tab-content">
            <div class="grid">
                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">‚ùå</span>
                        <h3 class="scenario-title">Wrong Git Root</h3>
                    </div>
                    
                    <div class="problem-box">
                        <div class="problem-title">Problem:</div>
                        You ran <code>git init</code> in the wrong directory and Git is tracking too many files.
                    </div>

                    <div class="solution-box">
                        <div class="solution-title">Solution:</div>
                        <div class="code-block">
                            <button class="copy-button" onclick="copyCode(this)">Copy</button>
                            <pre># Navigate to wrong directory
cd ~/Documents

# Check if Git repo exists
ls -a

# Remove the wrong Git repo
rm -rf .git

# Navigate to correct project folder
cd ~/Documents/my-project

# Initialize Git in correct location
git init
git add .
git commit -m "Initial commit"</pre>
                        </div>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üîÑ</span>
                        <h3 class="scenario-title">Wrong Remote URL</h3>
                    </div>
                    
                    <div class="problem-box">
                        <div class="problem-title">Problem:</div>
                        You pushed to the wrong repository or need to change remote URL.
                    </div>

                    <div class="solution-box">
                        <div class="solution-title">Solution:</div>
                        <div class="code-block">
                            <button class="copy-button" onclick="copyCode(this)">Copy</button>
                            <pre># Check current remote
git remote -v

# Remove current remote
git remote remove origin

# Add correct remote
git remote add origin https://github.com/username/correct-repo.git

# Push to correct repository
git push -u origin main</pre>
                        </div>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">‚ö†Ô∏è</span>
                        <h3 class="scenario-title">Merge Conflicts</h3>
                    </div>
                    
                    <div class="problem-box">
                        <div class="problem-title">Problem:</div>
                        Git can't automatically merge changes from different branches.
                    </div>

                    <div class="solution-box">
                        <div class="solution-title">Solution:</div>
                        <div class="code-block">
                            <button class="copy-button" onclick="copyCode(this)">Copy</button>
                            <pre># When merge conflict occurs
git status                    # See conflicted files

# Edit conflicted files manually
# Look for markers: &lt;&lt;&lt;&lt;&lt;&lt;&lt;, =======, &gt;&gt;&gt;&gt;&gt;&gt;&gt;
# Choose which changes to keep

# After resolving conflicts
git add &lt;resolved-file&gt;
git commit

# Abort merge if needed
git merge --abort</pre>
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">üí° Pro Tip</div>
                        Use VS Code's built-in merge conflict resolver or tools like GitKraken for visual conflict resolution.
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">‚è™</span>
                        <h3 class="scenario-title">Undoing Commits</h3>
                    </div>
                    <p class="scenario-description">Various ways to undo changes depending on your situation.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Unstage file (keep changes)
git reset HEAD filename

# Undo last commit, keep changes staged
git reset --soft HEAD~1

# Undo last commit, keep changes unstaged
git reset HEAD~1

# Undo last commit, discard changes (DANGEROUS)
git reset --hard HEAD~1

# Undo multiple commits
git reset --hard HEAD~3

# Create new commit that undoes previous commit
git revert abc1234</pre>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">‚ö†Ô∏è Warning</div>
                        <code>git reset --hard</code> permanently destroys uncommitted changes. Use with caution.
                    </div>
                </div>
            </div>
        </div>

        <div id="advanced" class="tab-content">
            <div class="grid">
                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üîß</span>
                        <h3 class="scenario-title">Interactive Rebase</h3>
                    </div>
                    <p class="scenario-description">Rewrite commit history for cleaner project timeline.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Rebase last 3 commits interactively
git rebase -i HEAD~3

# Common rebase commands in editor:
# pick = use commit
# reword = edit commit message
# edit = stop to modify commit
# squash = combine with previous commit
# fixup = like squash but discard message
# drop = remove commit

# Force push after rebase (be careful!)
git push --force-with-lease</pre>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">‚ö†Ô∏è Warning</div>
                        Never rebase commits that have been pushed to shared branches. Only rebase private feature branches.
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üçí</span>
                        <h3 class="scenario-title">Cherry-picking</h3>
                    </div>
                    <p class="scenario-description">Apply specific commits to another branch.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Apply specific commit to current branch
git cherry-pick abc1234

# Apply multiple commits
git cherry-pick abc1234 def5678

# Apply commit range
git cherry-pick abc1234..def5678

# Cherry-pick without committing (for review)
git cherry-pick --no-commit abc1234</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üîç</span>
                        <h3 class="scenario-title">Advanced Search</h3>
                    </div>
                    <p class="scenario-description">Find commits, changes, and content across history.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Search for commits by message
git log --grep="auth"

# Search for commits by author
git log --author="john@example.com"

# Search for code changes
git log -S "function login"

# Search in commit diffs
git log -G "regex-pattern"

# Find when file was deleted
git log --follow -- filename

# Show commits that touched specific lines
git blame -L 10,20 filename</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üßπ</span>
                        <h3 class="scenario-title">Repository Cleanup</h3>
                    </div>
                    <p class="scenario-description">Maintain repository health and performance.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Remove untracked files and directories
git clean -fd

# Remove files from git but keep locally
git rm --cached filename
git rm --cached -r directory/

# Garbage collect and optimize
git gc

# Remove remote tracking branches that no longer exist
git remote prune origin

# Show repository size
du -sh .git

# Compress repository
git gc --aggressive</pre>
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">üîê</span>
                        <h3 class="scenario-title">Security & Secrets</h3>
                    </div>
                    <p class="scenario-description">Handle sensitive data and security concerns.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Remove sensitive file from history (NUCLEAR OPTION)
git filter-branch --force --index-filter \
  'git rm --cached --ignore-unmatch secrets.txt' \
  --prune-empty --tag-name-filter cat -- --all

# Modern alternative using git-filter-repo
git filter-repo --path secrets.txt --invert-paths

# Check for secrets before committing
git diff --cached | grep -i "password\|key\|secret"

# Set up git hooks for secret scanning
# (requires additional tooling like pre-commit hooks)</pre>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">üí° Pro Tip</div>
                        Use tools like <code>git-secrets</code>, <code>truffleHog</code>, or GitHub's secret scanning to prevent secrets from being committed.
                    </div>
                </div>

                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-icon">‚ö°</span>
                        <h3 class="scenario-title">Performance Optimization</h3>
                    </div>
                    <p class="scenario-description">Optimize Git performance for large repositories.</p>
                    
                    <div class="code-block">
                        <button class="copy-button" onclick="copyCode(this)">Copy</button>
                        <pre># Enable parallel processing
git config core.preloadindex true
git config core.fscache true

# Shallow clone for faster downloads
git clone --depth 1 https://github.com/user/repo.git

# Partial clone (Git 2.19+)
git clone --filter=blob:none https://github.com/user/repo.git

# Enable Git LFS for large files
git lfs install
git lfs track "*.zip"
git add .gitattributes

# Configure Git for better performance
git config pack.threads 4
git config pack.windowMemory 100m</pre>
                    </div>
                </div>
            </div>
        </div>

    <!-- Command Simulator Modal -->
    <div id="simulatorModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('simulatorModal')">&times;</span>
            <h2>Git Command Simulator</h2>
            <p>Practice commands safely. Your real repository will not be affected.</p>
            <div class="simulator-ui">
                <div id="gitGraph" class="git-graph">Initialize a repository with 'git init' to begin...</div>
                <div id="commandOutput" class="command-output">Ready to execute Git commands...</div>
                <div class="command-input-wrapper">
                    <span class="prompt">$</span>
                    <input type="text" id="commandInput" placeholder="e.g., git commit -m 'My first commit'">
                    <button onclick="executeCommand()">Execute</button>
                </div>
            </div>
            <button onclick="resetSimulator()">Reset Simulator</button>
        </div>
    </div>

    <!-- Decision Tree Modal -->
    <div id="decisionTreeModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('decisionTreeModal')">&times;</span>
            <h2>Decision Tree Assistant</h2>
            <p>Find the right command by answering a few questions.</p>
            <div id="decisionTreeContainer">
                <!-- Decision tree will be rendered here by JS -->
            </div>
        </div>
    </div>

        <footer>
            <p>Built for production environments. Save this reference and never get stuck with Git again.</p>
        </footer>
    </div>

    <script>
        // Modal functionality
        function openSimulator() {
            document.getElementById('simulatorModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function openDecisionTree() {
            document.getElementById('decisionTreeModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            resetDecisionTree();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const simulatorModal = document.getElementById('simulatorModal');
            const decisionModal = document.getElementById('decisionTreeModal');
            if (event.target === simulatorModal) {
                closeModal('simulatorModal');
            }
            if (event.target === decisionModal) {
                closeModal('decisionTreeModal');
            }
        }

        // Command Simulator Logic
        let gitState = {
            initialized: false,
            currentBranch: 'main',
            branches: [],
            commits: [],
            staged: [],
            unstaged: [],
            tags: [],
            remotes: []
        };

        function executeCommand() {
            const input = document.getElementById('commandInput');
            const command = input.value.trim();
            const output = document.getElementById('commandOutput');

            if (!command) return;

            output.innerHTML += `\n<span class="prompt">$ ${input.value}</span>`;
            
            try {
                const result = processGitCommand(command);
                output.innerHTML += `\n${result}`;
                updateVisualization();
            } catch (error) {
                output.innerHTML += `\n<span class="error">‚ùå Error: ${error.message}</span>`;
            }

            output.scrollTop = output.scrollHeight;
            input.value = '';
        }

        function processGitCommand(command) {
            const parts = command.split(' ');
            const gitCmd = parts[0];

            if (gitCmd !== 'git') {
                throw new Error('Commands must start with "git"');
            }
            
            const subCmd = parts[1];

            if (!gitState.initialized && subCmd !== 'init') {
                throw new Error('Not a git repository. Please run "git init" first.');
            }

            switch (subCmd) {
                case 'init':
                    if (gitState.initialized) {
                        return 'Repository already initialized';
                    }
                    gitState.initialized = true;
                    gitState.currentBranch = 'main';
                    gitState.branches = ['main'];
                    gitState.commits = [{ id: 'abc1234', message: 'Initial commit', branch: 'main' }];
                    return 'Initialized empty Git repository in /simulator/project';

                case 'checkout':
                    if (parts[2] === '-b' && parts[3]) {
                        const newBranch = parts[3];
                        if (gitState.branches.includes(newBranch)) {
                            throw new Error(`Branch '${newBranch}' already exists`);
                        }
                        gitState.branches.push(newBranch);
                        gitState.currentBranch = newBranch;
                        return `Switched to a new branch '${newBranch}'`;
                    } else if (parts[2] && gitState.branches.includes(parts[2])) {
                        gitState.currentBranch = parts[2];
                        return `Switched to branch '${parts[2]}'`;
                    } else if (parts[2]) {
                        throw new Error(`Branch '${parts[2]}' does not exist`);
                    } else {
                        throw new Error('Invalid checkout command');
                    }

                case 'add':
                    if (parts[2] === '.') {
                        gitState.staged = ['file1.js', 'file2.css', 'README.md'];
                        return 'Added 3 files to staging area';
                    } else if (parts[2]) {
                        if (!gitState.staged.includes(parts[2])) {
                           gitState.staged.push(parts[2]);
                        }
                        return `Added ${parts[2]} to staging area`;
                    }
                    throw new Error('Specify a file to add or use "." for all files.');

                case 'commit':
                    if (gitState.staged.length === 0) {
                        return 'On branch ' + gitState.currentBranch + '\n' + 'nothing to commit, working tree clean';
                    }
                    const commitId = Math.random().toString(36).substr(2, 7);
                    const msgIndex = command.indexOf('-m');
                    const message = msgIndex !== -1 ? command.substring(msgIndex + 2).replace(/["\']/g, '').trim() : 'Commit message';
                    
                    gitState.commits.push({
                        id: commitId,
                        message,
                        branch: gitState.currentBranch,
                        parent: gitState.commits.find(c => c.branch === gitState.currentBranch)?.id || null
                    });
                    gitState.staged = [];
                    return `[${gitState.currentBranch} ${commitId}] ${message}`;

                case 'merge':
                    const mergeBranch = parts[2];
                    if (!mergeBranch || !gitState.branches.includes(mergeBranch)) {
                        throw new Error(`Branch '${mergeBranch}' does not exist`);
                    }
                    if (mergeBranch === gitState.currentBranch) {
                        throw new Error('Already on \'' + mergeBranch + '\'');
                    }
                    const mergeId = Math.random().toString(36).substr(2, 7);
                    gitState.commits.push({
                        id: mergeId,
                        message: `Merge branch '${mergeBranch}' into ${gitState.currentBranch}`,
                        branch: gitState.currentBranch,
                        type: 'merge'
                    });
                    return `Merged branch '${mergeBranch}' into '${gitState.currentBranch}'`;

                case 'branch':
                     if (parts[2]) {
                        const newBranch = parts[2];
                        if (gitState.branches.includes(newBranch)) {
                            throw new Error(`Branch '${newBranch}' already exists`);
                        }
                        gitState.branches.push(newBranch);
                        return `Created branch '${newBranch}'`;
                    } else {
                        return gitState.branches.map(b => 
                            b === gitState.currentBranch ? `* ${b}` : `  ${b}`
                        ).join('\n');
                    }

                case 'status':
                    let status = `On branch ${gitState.currentBranch}\n`;
                    if (gitState.staged.length > 0) {
                        status += 'Changes to be committed:\n';
                        gitState.staged.forEach(file => {
                            status += `  <span class="staged">(new file)  ${file}</span>\n`;
                        });
                    } else {
                        status += 'nothing to commit, working tree clean';
                    }
                    return status;

                default:
                    throw new Error(`'${subCmd}' is not a recognized git command in this simulator`);
            }
        }

        function updateVisualization() {
            const graph = document.getElementById('gitGraph');
            
            if (!gitState.initialized) {
                graph.innerHTML = '<span class="placeholder">Initialize a repository with \'git init\' to begin...</span>';
                return;
            }

            let viz = `<strong>Branches:</strong>\n`;
            gitState.branches.forEach(branch => {
                const indicator = branch === gitState.currentBranch ? '* ' : '  ';
                viz += `<span class="branch ${branch === gitState.currentBranch ? 'active' : ''}">${indicator}${branch}</span>\n`;
            });

            viz += '\n<strong>Commit History (main):</strong>\n';
            const mainCommits = gitState.commits.filter(c => c.branch === 'main').slice(-4).reverse();
            mainCommits.forEach((commit, index) => {
                viz += `‚óè <span class="commit-id">${commit.id}</span> - ${commit.message}\n`;
                if (index < mainCommits.length - 1) viz += '‚îÇ\n';
            });
            
            const otherBranches = gitState.branches.filter(b => b !== 'main');
            otherBranches.forEach(branch => {
                const branchCommits = gitState.commits.filter(c => c.branch === branch).slice(-2).reverse();
                if (branchCommits.length > 0) {
                    viz += `\n<strong>History (${branch}):</strong>\n`;
                    branchCommits.forEach((commit, index) => {
                         viz += `‚óè <span class="commit-id">${commit.id}</span> - ${commit.message}\n`;
                         if (index < branchCommits.length - 1) viz += '‚îÇ\n';
                    });
                }
            });


            graph.innerHTML = viz;
        }

        function resetSimulator() {
            gitState = {
                initialized: false,
                currentBranch: 'main',
                branches: [],
                commits: [],
                staged: [],
                unstaged: [],
                tags: [],
                remotes: []
            };
            document.getElementById('commandOutput').innerHTML = 'Repository reset. Ready to execute Git commands...';
            updateVisualization();
            document.getElementById('gitGraph').innerHTML = '<span class="placeholder">Initialize a repository with \'git init\' to begin...</span>';
        }

        // Decision Tree Logic
        const decisionTree = {
            'start': {
                question: 'What do you need help with?',
                options: {
                    'undo': {
                        title: 'Undo something',
                        question: 'What do you want to undo?',
                        options: {
                            'last-commit': {
                                title: 'Last Commit',
                                result: {
                                    title: 'Undo Last Commit',
                                    commands: [
                                        'git reset --soft HEAD~1  # Keep changes staged',
                                        'git reset HEAD~1         # Keep changes unstaged',
                                        'git reset --hard HEAD~1  # Discard changes (DANGEROUS)'
                                    ],
                                    explanation: 'Use --soft to keep changes, --hard to completely remove them.'
                                }
                            },
                            'staging': {
                                title: 'Staged Changes',
                                result: {
                                    title: 'Unstage Files',
                                    commands: [
                                        'git reset HEAD filename    # Unstage specific file',
                                        'git reset HEAD .          # Unstage all files'
                                    ],
                                    explanation: 'Removes files from staging area but keeps changes in working directory.'
                                }
                            }
                        }
                    },
                    'collaborate': {
                        title: 'Collaborate with others',
                        question: 'What collaboration task?',
                        options: {
                            'pull-request': {
                                title: 'Create Pull Request',
                                result: {
                                    title: 'Pull Request Workflow',
                                    commands: [
                                        'git checkout -b feature/my-feature',
                                        'git add . && git commit -m "feat: add new feature"',
                                        'git push -u origin feature/my-feature',
                                        '# Create PR in GitHub/GitLab interface'
                                    ],
                                    explanation: 'Follow feature branch workflow for collaborative development.'
                                }
                            },
                            'merge-conflict': {
                                title: 'Resolve Merge Conflict',
                                result: {
                                    title: 'Merge Conflict Resolution',
                                    commands: [
                                        'git status                  # See conflicted files',
                                        '# Edit files to resolve conflicts',
                                        'git add <resolved-file>',
                                        'git commit',
                                        'git merge --abort          # If you want to cancel'
                                    ],
                                    explanation: 'Look for <<<<<<< ======= >>>>>>> markers in conflicted files.'
                                }
                            }
                        }
                    },
                    'emergency': {
                        title: 'Fix an emergency',
                        question: 'What\'s the emergency?',
                        options: {
                            'pushed-secrets': {
                                title: 'Pushed Secrets/Passwords',
                                result: {
                                    title: 'üö® CRITICAL: Secrets in Repository',
                                    commands: [
                                        '# STEP 1: IMMEDIATELY rotate all exposed secrets!',
                                        'git filter-repo --path config/secrets.json --invert-paths',
                                        'git push --force-with-lease origin main',
                                        '# STEP 2: Everyone must re-clone the repository'
                                    ],
                                    explanation: 'Rotate secrets FIRST, then clean Git history. Coordinate with your team before force pushing.'
                                }
                            },
                            'lost-commits': {
                                title: 'Lost Important Commits',
                                result: {
                                    title: 'Recover Lost Commits',
                                    commands: [
                                        'git reflog --all           # Find lost commits',
                                        'git checkout <commit-hash> # Restore specific commit',
                                        'git checkout -b recovery-branch',
                                        'git cherry-pick <commit-hash>'
                                    ],
                                    explanation: 'Git rarely loses data permanently. Check reflog for recent activity.'
                                }
                            }
                        }
                    }
                }
            }
        };

        function resetDecisionTree() {
            renderDecisionStep(decisionTree['start']);
        }

        function renderDecisionStep(step) {
            const container = document.getElementById('decisionTreeContainer');
            container.innerHTML = ''; // Clear previous content

            if (!step) {
                container.innerHTML = '<p class="error">Something went wrong. Please reset.</p>';
                const resetButton = document.createElement('button');
                resetButton.textContent = 'Start Over';
                resetButton.onclick = resetDecisionTree;
                container.appendChild(resetButton);
                return;
            }

            const title = document.createElement('h3');
            title.textContent = step.question || step.title;
            container.appendChild(title);

            if (step.options) {
                const optionsList = document.createElement('div');
                optionsList.className = 'decision-options';
                for (const key in step.options) {
                    const option = step.options[key];
                    const button = document.createElement('button');
                    button.textContent = option.title;
                    button.onclick = () => renderDecisionStep(option);
                    optionsList.appendChild(button);
                }
                container.appendChild(optionsList);
            } else if (step.result) {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'decision-result';
                
                const resultTitle = document.createElement('h4');
                resultTitle.textContent = step.result.title;
                resultDiv.appendChild(resultTitle);

                const explanation = document.createElement('p');
                explanation.textContent = step.result.explanation;
                resultDiv.appendChild(explanation);

                const codeBlock = document.createElement('div');
                codeBlock.className = 'code-block';
                const pre = document.createElement('pre');
                pre.textContent = step.result.commands.join('\n');
                codeBlock.appendChild(pre);
                resultDiv.appendChild(codeBlock);

                container.appendChild(resultDiv);
            }
            
            const resetButton = document.createElement('button');
            resetButton.textContent = 'Start Over';
            resetButton.onclick = resetDecisionTree;
            container.appendChild(resetButton);
        }

        function showTab(evt, tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab
            if (evt) {
                evt.currentTarget.classList.add('active');
            } else {
                // Fallback for initial load
                document.querySelector(`.nav-tab[onclick*="'${tabName}'"]`).classList.add('active');
            }
        }

        function copyCode(button) {
            const codeBlock = button.nextElementSibling;
            const code = codeBlock.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.style.background = 'var(--success)';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = 'var(--bg-tertiary)';
                }, 2000);
            });
        }

        // Add smooth scrolling for internal links
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize with first tab
            showTab(null, 'basics');

            // Add keypress listener for simulator
            const commandInput = document.getElementById('commandInput');
            if (commandInput) {
                commandInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        executeCommand();
                    }
                });
            }
        });
    </script>
</body>
</html>